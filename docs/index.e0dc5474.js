!function(e,t,n,o,s){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r="function"==typeof i[o]&&i[o],a=r.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function d(t,n){if(!a[t]){if(!e[t]){var s="function"==typeof i[o]&&i[o];if(!n&&s)return s(t,!0);if(r)return r(t,!0);if(l&&"string"==typeof t)return l(t);var c=Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}h.resolve=function(n){var o=e[t][1][n];return null!=o?o:n},h.cache={};var u=a[t]=new d.Module(t);e[t][0].call(u.exports,h,u,u.exports,i)}return a[t].exports;function h(e){var t=h.resolve(e);return!1===t?{}:d(t)}}d.isParcelRequire=!0,d.Module=function(e){this.id=e,this.bundle=d,this.exports={}},d.modules=e,d.cache=a,d.parent=r,d.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(d,"root",{get:function(){return i[o]}}),i[o]=d;for(var c=0;c<t.length;c++)d(t[c]);if(n){var u=d(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd&&define(function(){return u})}}({eqojD:[function(e,t,n,o){var s=e("./filterBooks.js"),i=e("./bookOperations.js"),r=e("./chatbot.js");(0,r.initializeChatbot)(),document.addEventListener("DOMContentLoaded",()=>{(0,i.initializeModals)();let e=document.getElementById("chat-history"),t=document.getElementById("chat-input"),n=document.getElementById("send-btn"),o=document.getElementById("bookList"),a=document.getElementById("bookForm"),l=document.getElementById("searchBar"),d=document.getElementById("filterGenre");function c(t,n="bot"){let o=document.createElement("div");o.classList.add("chat-message","user"===n?"user-message":"bot-message"),o.textContent=t,e.appendChild(o),e.scrollTop=e.scrollHeight}async function u(){let e=l.value.toLowerCase(),t=d.value;await (0,s.filterAndDisplayBooks)(e,t,o)}n.addEventListener("click",async()=>{let e=t.value.trim();if(e)c(e,"user"),t.value="",!await (0,r.handleLocalCommands)(e,c)&&c(await (0,r.askChatBot)(e),"bot")}),t.addEventListener("keyup",e=>{"Enter"===e.key&&n.click()}),a&&a.addEventListener("submit",async e=>{e.preventDefault();let t=document.getElementById("title").value.trim(),n=document.getElementById("author").value.trim(),o=document.getElementById("genre").value,s=document.getElementById("rating").value;t&&n&&o&&s&&(await (0,i.addBook)(t,n,o,s),a.reset())}),o.addEventListener("click",e=>{if(e.target.classList.contains("edit-btn")){let t=e.target.getAttribute("data-id");(0,i.showEditModal)(t)}else if(e.target.classList.contains("delete-btn")){let t=e.target.getAttribute("data-id");(0,i.showDeleteModal)(t)}}),l&&l.addEventListener("input",u),d&&d.addEventListener("change",u),u(),(0,i.loadBooks)()})},{"./filterBooks.js":"11t4W","./bookOperations.js":"2qEkO","./chatbot.js":"knVpW"}],"11t4W":[function(e,t,n,o){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(n),s.export(n,"filterAndDisplayBooks",()=>a);var i=e("firebase/firestore"),r=e("./firebase.js");async function a(e,t,n){try{let o=(0,i.collection)(r.db,"books"),s=(await (0,i.getDocs)(o)).docs.map(e=>({id:e.id,...e.data()})).filter(n=>{let o=n.title.toLowerCase().includes(e)||n.author.toLowerCase().includes(e),s=!t||n.genre===t;return o&&s});n.innerHTML="",s.forEach(e=>{let t=document.createElement("li");t.innerHTML=`
        <span><strong>${e.title}</strong> by ${e.author} (${e.genre}) \u{2B50}${e.rating}</span>
        <button class="edit-btn" data-id="${e.id}">Edit</button>
        <button class="delete-btn" data-id="${e.id}">Delete</button>
      `,n.appendChild(t)})}catch(e){console.error("Error filtering books:",e)}}},{"firebase/firestore":"59KHr","./firebase.js":"6JwWS","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}],"2qEkO":[function(e,t,n,o){let s,i,r,a,l,d;var c=e("@parcel/transformer-js/src/esmodule-helpers.js");c.defineInteropFlag(n),c.export(n,"addBook",()=>p),c.export(n,"editBook",()=>m),c.export(n,"deleteBookByTitle",()=>E),c.export(n,"loadBooks",()=>y),c.export(n,"displayBook",()=>b),c.export(n,"initializeModals",()=>C),c.export(n,"showEditModal",()=>v),c.export(n,"hideEditModal",()=>O),c.export(n,"showDeleteModal",()=>I),c.export(n,"hideDeleteModal",()=>w);var u=e("firebase/firestore"),h=e("./firebase.js");let f=null,g=null;async function p(e,t,n,o){try{return await (0,u.addDoc)((0,u.collection)(h.db,"books"),{title:e,author:t,genre:n,rating:o}),await y(),!0}catch(e){return console.error("Error adding book:",e),!1}}async function m(e,t,n,o,s){try{let i=(0,u.collection)(h.db,"books"),r=(await (0,u.getDocs)(i)).docs.find(t=>t.data().title.toLowerCase()===e.toLowerCase());if(r)return await (0,u.updateDoc)((0,u.doc)(h.db,"books",r.id),{title:t,author:n,genre:o,rating:s}),await y(),!0;return!1}catch(e){return console.error("Error editing book:",e),!1}}async function E(e){try{let t=(0,u.collection)(h.db,"books"),n=(await (0,u.getDocs)(t)).docs.find(t=>t.data().title.toLowerCase()===e.toLowerCase());if(n)return await (0,u.deleteDoc)((0,u.doc)(h.db,"books",n.id)),await y(),!0;return!1}catch(e){return console.error("Error deleting book:",e),!1}}async function y(){let e=document.getElementById("bookList");if(e)try{let t=(0,u.collection)(h.db,"books"),n=(await (0,u.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));e.innerHTML="",n.forEach(t=>{b(t,e)})}catch(e){console.error("Error loading books:",e)}}function b(e,t){let n=document.createElement("li");n.innerHTML=`
    <span><strong>${e.title}</strong> by ${e.author} (${e.genre}) \u{2B50}${e.rating}</span>
    <button class="edit-btn" data-id="${e.id}">Edit</button>
    <button class="delete-btn" data-id="${e.id}">Delete</button>
  `,t.appendChild(n)}function C(){s=document.getElementById("editModal"),i=document.getElementById("editForm"),r=document.querySelector(".close-btn"),a=document.getElementById("deleteModal"),l=document.getElementById("confirmDelete"),d=document.getElementById("cancelDelete"),r&&r.addEventListener("click",O),window.addEventListener("click",e=>{e.target===s&&O(),e.target===a&&w()}),l&&l.addEventListener("click",async()=>{g&&(await T(g),g=null),w()}),d&&d.addEventListener("click",()=>{g=null,w()}),i&&i.addEventListener("submit",async e=>{e.preventDefault();let t=document.getElementById("editTitle").value.trim(),n=document.getElementById("editAuthor").value.trim(),o=document.getElementById("editGenre").value,s=document.getElementById("editRating").value;try{await (0,u.updateDoc)((0,u.doc)(h.db,"books",f),{title:t,author:n,genre:o,rating:s}),O(),await y()}catch(e){console.error("Error updating book:",e)}})}function v(e){(0,u.getDoc)((0,u.doc)(h.db,"books",e)).then(t=>{if(t.exists()){let n=t.data();f=e,document.getElementById("editTitle").value=n.title,document.getElementById("editAuthor").value=n.author,document.getElementById("editGenre").value=n.genre,document.getElementById("editRating").value=n.rating,s&&(s.style.display="block")}else console.log("Book doesn't exist!")}).catch(e=>{console.error("Error fetching book for edit:",e)})}function O(){s&&(s.style.display="none")}function I(e){g=e,a&&(a.style.display="block")}function w(){a&&(a.style.display="none")}async function T(e){try{return await (0,u.deleteDoc)((0,u.doc)(h.db,"books",e)),await y(),!0}catch(e){return console.error("Error deleting book:",e),!1}}},{"firebase/firestore":"59KHr","./firebase.js":"6JwWS","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}],knVpW:[function(e,t,n,o){let s,i;var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"initializeChatbot",()=>u),r.export(n,"askChatBot",()=>h),r.export(n,"handleLocalCommands",()=>f);var a=e("@google/generative-ai"),l=e("firebase/firestore"),d=e("./firebase.js"),c=e("./bookOperations.js");async function u(){s=(await (0,l.getDoc)((0,l.doc)(d.db,"apikey","googlegenai"))).data().key,i=new a.GoogleGenerativeAI(s).getGenerativeModel({model:"gemini-1.5-flash"})}async function h(e){if(!i)return"Chatbot is not ready yet. Please wait a moment and try again.";try{let t=await i.generateContent(e);if(!t.candidates||0===t.candidates.length)return"I'm sorry, I don't understand. Can you please rephrase? Or contact the developer for help."}catch(e){return console.error("Error calling AI model:",e),"Sorry, something went wrong with the AI service."}}async function f(e,t){let n=e.toLowerCase().trim();if("help"===n||n.includes("tutorial"))return t("Welcome to BookLog! Here are some commands you can use:\n• add book [Title] by [Author], [Genre], [Rating]\n• edit book [Old Title], [New Title], [New Author], [New Genre], [New Rating]\n• delete book [Title]\n• suggest book (or recommend book)\nYou can also ask questions like 'How do I search for books?' or 'What does the add book button do?'\nIf you run into issues, simply type 'I have an error' for troubleshooting tips.","bot"),!0;if(n.includes("how do i search")||n.includes("how to search"))return t("To search for a book, type keywords into the search bar; the list filters automatically by title or author.","bot"),!0;if(n.includes("how do i filter")||n.includes("how to filter"))return t("To filter your book list, select a genre from the dropdown menu. The list updates automatically.","bot"),!0;if(n.includes("not working")||n.includes("error")||n.includes("issue"))return t("If you're experiencing issues, please check your internet connection, and try refreshing the page. If the problem persists, please contact support.","bot"),!0;if(n.includes("what does")&&n.includes("button")&&n.includes("do"))return n.includes("add book")?t("The 'Add Book' button submits a form when you input a new book's details (Title, Author, Genre, Rating) to add it to your log.","bot"):n.includes("edit")?t("The 'Edit' button opens a modal that lets you update the details of the selected book.","bot"):n.includes("delete")?t("The 'Delete' button opens a confirmation modal to remove the selected book from your log.","bot"):t("I can explain any feature. For example, try asking 'What does the add book button do?'","bot"),!0;if(n.startsWith("add book")){let n=e.slice(8).trim().split(",");if(n.length>=2){let e=n[0].split("by");if(e.length>=2){let o=e[0].trim(),s=e[1].trim(),i=n[1].trim(),r=n[2]?n[2].trim():"N/A";await (0,c.addBook)(o,s,i,r),t(`Added book "${o}" by ${s} (Genre: ${i}, Rating: ${r})`,"bot")}else t("Please provide details as: add book Title by Author, Genre, Rating","bot")}else t("Please provide complete details: add book Title by Author, Genre, Rating","bot");return!0}if(n.startsWith("edit book")){let n=e.slice(9).trim().split(",");if(5===n.length){let e=n[0].trim(),o=n[1].trim(),s=n[2].trim(),i=n[3].trim(),r=n[4].trim();(0,c.editBook)(e,o,s,i,r).then(n=>{n?t(`Updated book "${e}" to: Title: "${o}", Author: "${s}", Genre: "${i}", Rating: "${r}"`,"bot"):t(`Book "${e}" not found.`,"bot")})}else t('Use: "edit book Old Title, New Title, New Author, New Genre, New Rating"',"bot");return!0}if(n.startsWith("delete book")){let n=e.slice(11).trim();return n?await (0,c.deleteBookByTitle)(n)?t(`Deleted book "${n}"`,"bot"):t(`Book "${n}" not found.`,"bot"):t("Please specify a book to delete: delete book Title","bot"),!0}}},{"@google/generative-ai":"2jUEE","firebase/firestore":"59KHr","./firebase.js":"6JwWS","./bookOperations.js":"2qEkO","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}],"2jUEE":[function(e,t,n,o){var s,i,r,a,l,d,c,u,h,f,g,p,m,E,y,b,C,v,O,I,w,T,_,A,k=e("@parcel/transformer-js/src/esmodule-helpers.js");k.defineInteropFlag(n),k.export(n,"BlockReason",()=>O),k.export(n,"ChatSession",()=>en),k.export(n,"DynamicRetrievalMode",()=>_),k.export(n,"ExecutableCodeLanguage",()=>E),k.export(n,"FinishReason",()=>I),k.export(n,"FunctionCallingMode",()=>T),k.export(n,"GenerativeModel",()=>er),k.export(n,"GoogleGenerativeAI",()=>ea),k.export(n,"GoogleGenerativeAIError",()=>N),k.export(n,"GoogleGenerativeAIFetchError",()=>x),k.export(n,"GoogleGenerativeAIRequestInputError",()=>M),k.export(n,"GoogleGenerativeAIResponseError",()=>S),k.export(n,"HarmBlockThreshold",()=>C),k.export(n,"HarmCategory",()=>b),k.export(n,"HarmProbability",()=>v),k.export(n,"Outcome",()=>y),k.export(n,"POSSIBLE_ROLES",()=>R),k.export(n,"SchemaType",()=>m),k.export(n,"TaskType",()=>w),(s=m||(m={})).STRING="string",s.NUMBER="number",s.INTEGER="integer",s.BOOLEAN="boolean",s.ARRAY="array",s.OBJECT="object",(i=E||(E={})).LANGUAGE_UNSPECIFIED="language_unspecified",i.PYTHON="python",(r=y||(y={})).OUTCOME_UNSPECIFIED="outcome_unspecified",r.OUTCOME_OK="outcome_ok",r.OUTCOME_FAILED="outcome_failed",r.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R=["user","model","function","system"];(a=b||(b={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",(l=C||(C={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",l.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",l.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",l.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",l.BLOCK_NONE="BLOCK_NONE",(d=v||(v={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",d.NEGLIGIBLE="NEGLIGIBLE",d.LOW="LOW",d.MEDIUM="MEDIUM",d.HIGH="HIGH",(c=O||(O={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",c.SAFETY="SAFETY",c.OTHER="OTHER",(u=I||(I={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",u.STOP="STOP",u.MAX_TOKENS="MAX_TOKENS",u.SAFETY="SAFETY",u.RECITATION="RECITATION",u.LANGUAGE="LANGUAGE",u.OTHER="OTHER",(h=w||(w={})).TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",h.RETRIEVAL_QUERY="RETRIEVAL_QUERY",h.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",h.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",h.CLASSIFICATION="CLASSIFICATION",h.CLUSTERING="CLUSTERING",(f=T||(T={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",f.AUTO="AUTO",f.ANY="ANY",f.NONE="NONE",(g=_||(_={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",g.MODE_DYNAMIC="MODE_DYNAMIC";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class S extends N{constructor(e,t){super(e),this.response=t}}class x extends N{constructor(e,t,n,o){super(e),this.status=t,this.statusText=n,this.errorDetails=o}}class M extends N{}(p=A||(A={})).GENERATE_CONTENT="generateContent",p.STREAM_GENERATE_CONTENT="streamGenerateContent",p.COUNT_TOKENS="countTokens",p.EMBED_CONTENT="embedContent",p.BATCH_EMBED_CONTENTS="batchEmbedContents";class D{constructor(e,t,n,o,s){this.model=e,this.task=t,this.apiKey=n,this.stream=o,this.requestOptions=s}toString(){var e,t;let n=(null===(e=this.requestOptions)||void 0===e?void 0:e.apiVersion)||"v1beta",o=(null===(t=this.requestOptions)||void 0===t?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com",s=`${o}/${n}/${this.model}:${this.task}`;return this.stream&&(s+="?alt=sse"),s}}async function L(e){var t;let n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",function(e){let t=[];return(null==e?void 0:e.apiClient)&&t.push(e.apiClient),t.push("genai-js/0.21.0"),t.join(" ")}(e.requestOptions)),n.append("x-goog-api-key",e.apiKey);let o=null===(t=e.requestOptions)||void 0===t?void 0:t.customHeaders;if(o){if(!(o instanceof Headers))try{o=new Headers(o)}catch(e){throw new M(`unable to convert customHeaders value ${JSON.stringify(o)} to Headers: ${e.message}`)}for(let[e,t]of o.entries()){if("x-goog-api-key"===e)throw new M(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new M(`Header name ${e} can only be set using the apiClient field`);n.append(e,t)}}return n}async function B(e,t,n,o,s,i){let r=new D(e,t,n,o,i);return{url:r.toString(),fetchOptions:Object.assign(Object.assign({},function(e){let t={};if((null==e?void 0:e.signal)!==void 0||(null==e?void 0:e.timeout)>=0){let n=new AbortController;(null==e?void 0:e.timeout)>=0&&setTimeout(()=>n.abort(),e.timeout),(null==e?void 0:e.signal)&&e.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}(i)),{method:"POST",headers:await L(r),body:s})}}async function j(e,t,n,o,s,i={},r=fetch){let{url:a,fetchOptions:l}=await B(e,t,n,o,s,i);return G(a,l,r)}async function G(e,t,n=fetch){let o;try{o=await n(e,t)}catch(t){!function(e,t){let n=e;throw e instanceof x||e instanceof M||((n=new N(`Error fetching from ${t.toString()}: ${e.message}`)).stack=e.stack),n}(t,e)}return o.ok||await $(o,e),o}async function $(e,t){let n,o="";try{let t=await e.json();o=t.error.message,t.error.details&&(o+=` ${JSON.stringify(t.error.details)}`,n=t.error.details)}catch(e){}throw new x(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${o}`,e.status,e.statusText,n)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),P(e.candidates[0]))throw new S(`${q(e)}`,e);return function(e){var t,n,o,s;let i=[];if(null===(n=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===n?void 0:n.parts)for(let t of null===(s=null===(o=e.candidates)||void 0===o?void 0:o[0].content)||void 0===s?void 0:s.parts)t.text&&i.push(t.text),t.executableCode&&i.push("\n```"+t.executableCode.language+"\n"+t.executableCode.code+"\n```\n"),t.codeExecutionResult&&i.push("\n```\n"+t.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}(e)}if(e.promptFeedback)throw new S(`Text not available. ${q(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),P(e.candidates[0]))throw new S(`${q(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),F(e)[0]}if(e.promptFeedback)throw new S(`Function call not available. ${q(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),P(e.candidates[0]))throw new S(`${q(e)}`,e);return F(e)}if(e.promptFeedback)throw new S(`Function call not available. ${q(e)}`,e)},e}function F(e){var t,n,o,s;let i=[];if(null===(n=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===n?void 0:n.parts)for(let t of null===(s=null===(o=e.candidates)||void 0===o?void 0:o[0].content)||void 0===s?void 0:s.parts)t.functionCall&&i.push(t.functionCall);return i.length>0?i:void 0}let U=[I.RECITATION,I.SAFETY,I.LANGUAGE];function P(e){return!!e.finishReason&&U.includes(e.finishReason)}function q(e){var t,n,o;let s="";if((!e.candidates||0===e.candidates.length)&&e.promptFeedback)s+="Response was blocked",(null===(t=e.promptFeedback)||void 0===t?void 0:t.blockReason)&&(s+=` due to ${e.promptFeedback.blockReason}`),(null===(n=e.promptFeedback)||void 0===n?void 0:n.blockReasonMessage)&&(s+=`: ${e.promptFeedback.blockReasonMessage}`);else if(null===(o=e.candidates)||void 0===o?void 0:o[0]){let t=e.candidates[0];P(t)&&(s+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(s+=`: ${t.finishMessage}`))}return s}function K(e){return this instanceof K?(this.v=e,this):new K(e)}"function"==typeof SuppressedError&&SuppressedError;/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Y=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function W(e){let t=[],n=e.getReader();for(;;){let{done:e,value:o}=await n.read();if(e)return H(function(e){let t=e[e.length-1],n={promptFeedback:null==t?void 0:t.promptFeedback};for(let t of e){if(t.candidates)for(let e of t.candidates){let t=e.index;if(n.candidates||(n.candidates=[]),n.candidates[t]||(n.candidates[t]={index:e.index}),n.candidates[t].citationMetadata=e.citationMetadata,n.candidates[t].groundingMetadata=e.groundingMetadata,n.candidates[t].finishReason=e.finishReason,n.candidates[t].finishMessage=e.finishMessage,n.candidates[t].safetyRatings=e.safetyRatings,e.content&&e.content.parts){n.candidates[t].content||(n.candidates[t].content={role:e.content.role||"user",parts:[]});let o={};for(let s of e.content.parts)s.text&&(o.text=s.text),s.functionCall&&(o.functionCall=s.functionCall),s.executableCode&&(o.executableCode=s.executableCode),s.codeExecutionResult&&(o.codeExecutionResult=s.codeExecutionResult),0===Object.keys(o).length&&(o.text=""),n.candidates[t].content.parts.push(o)}}t.usageMetadata&&(n.usageMetadata=t.usageMetadata)}return n}(t));t.push(o)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J(e,t,n,o){return function(e){let[t,n]=(function(e){let t=e.getReader();return new ReadableStream({start(e){let n="";return function o(){return t.read().then(({value:t,done:s})=>{let i;if(s){if(n.trim()){e.error(new N("Failed to parse stream"));return}e.close();return}let r=(n+=t).match(Y);for(;r;){try{i=JSON.parse(r[1])}catch(t){e.error(new N(`Error parsing JSON response: "${r[1]}"`));return}e.enqueue(i),r=(n=n.substring(r[0].length)).match(Y)}return o()})}()}})})(e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0}))).tee();return{stream:function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var o,s=n.apply(e,t||[]),i=[];return o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o;function r(e){s[e]&&(o[e]=function(t){return new Promise(function(n,o){i.push([e,t,n,o])>1||a(e,t)})})}function a(e,t){try{var n;(n=s[e](t)).value instanceof K?Promise.resolve(n.value.v).then(l,d):c(i[0][2],n)}catch(e){c(i[0][3],e)}}function l(e){a("next",e)}function d(e){a("throw",e)}function c(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}(this,arguments,function*(){let t=e.getReader();for(;;){let{value:e,done:n}=yield K(t.read());if(n)break;yield yield K(H(e))}})}(t),response:W(n)}}(await j(t,A.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(n),o))}async function V(e,t,n,o){let s=await j(t,A.GENERATE_CONTENT,e,!1,JSON.stringify(n),o);return{response:H(await s.json())}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(e){if(null!=e){if("string"==typeof e)return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function z(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(let n of e)"string"==typeof n?t.push({text:n}):t.push(n);return function(e){let t={role:"user",parts:[]},n={role:"function",parts:[]},o=!1,s=!1;for(let i of e)"functionResponse"in i?(n.parts.push(i),s=!0):(t.parts.push(i),o=!0);if(o&&s)throw new N("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!o&&!s)throw new N("No content is provided for sending chat message.");return o?t:n}(t)}function Q(e){let t;return t=e.contents?e:{contents:[z(e)]},e.systemInstruction&&(t.systemInstruction=X(e.systemInstruction)),t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],ee={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]},et="SILENT_ERROR";class en{constructor(e,t,n,o={}){this.model=t,this.params=n,this._requestOptions=o,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==n?void 0:n.history)&&(function(e){let t=!1;for(let n of e){let{role:e,parts:o}=n;if(!t&&"user"!==e)throw new N(`First content should be with role 'user', got ${e}`);if(!R.includes(e))throw new N(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(R)}`);if(!Array.isArray(o))throw new N("Content should have 'parts' property with an array of Parts");if(0===o.length)throw new N("Each Content should have at least one part");let s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let e of o)for(let t of Z)t in e&&(s[t]+=1);let i=ee[e];for(let t of Z)if(!i.includes(t)&&s[t]>0)throw new N(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var n,o,s,i,r,a;let l;await this._sendPromise;let d=z(e),c={safetySettings:null===(n=this.params)||void 0===n?void 0:n.safetySettings,generationConfig:null===(o=this.params)||void 0===o?void 0:o.generationConfig,tools:null===(s=this.params)||void 0===s?void 0:s.tools,toolConfig:null===(i=this.params)||void 0===i?void 0:i.toolConfig,systemInstruction:null===(r=this.params)||void 0===r?void 0:r.systemInstruction,cachedContent:null===(a=this.params)||void 0===a?void 0:a.cachedContent,contents:[...this._history,d]},u=Object.assign(Object.assign({},this._requestOptions),t);return this._sendPromise=this._sendPromise.then(()=>V(this._apiKey,this.model,c,u)).then(e=>{var t;if(e.response.candidates&&e.response.candidates.length>0){this._history.push(d);let n=Object.assign({parts:[],role:"model"},null===(t=e.response.candidates)||void 0===t?void 0:t[0].content);this._history.push(n)}else{let t=q(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}l=e}),await this._sendPromise,l}async sendMessageStream(e,t={}){var n,o,s,i,r,a;await this._sendPromise;let l=z(e),d={safetySettings:null===(n=this.params)||void 0===n?void 0:n.safetySettings,generationConfig:null===(o=this.params)||void 0===o?void 0:o.generationConfig,tools:null===(s=this.params)||void 0===s?void 0:s.tools,toolConfig:null===(i=this.params)||void 0===i?void 0:i.toolConfig,systemInstruction:null===(r=this.params)||void 0===r?void 0:r.systemInstruction,cachedContent:null===(a=this.params)||void 0===a?void 0:a.cachedContent,contents:[...this._history,l]},c=Object.assign(Object.assign({},this._requestOptions),t),u=J(this._apiKey,this.model,d,c);return this._sendPromise=this._sendPromise.then(()=>u).catch(e=>{throw Error(et)}).then(e=>e.response).then(e=>{if(e.candidates&&e.candidates.length>0){this._history.push(l);let t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{let t=q(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}}).catch(e=>{e.message!==et&&console.error(e)}),u}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(e,t,n,o){return(await j(t,A.COUNT_TOKENS,e,!1,JSON.stringify(n),o)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function es(e,t,n,o){return(await j(t,A.EMBED_CONTENT,e,!1,JSON.stringify(n),o)).json()}async function ei(e,t,n,o){let s=n.requests.map(e=>Object.assign(Object.assign({},e),{model:t}));return(await j(t,A.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:s}),o)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,t,n={}){this.apiKey=e,this._requestOptions=n,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=X(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var n;let o=Q(e),s=Object.assign(Object.assign({},this._requestOptions),t);return V(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(n=this.cachedContent)||void 0===n?void 0:n.name},o),s)}async generateContentStream(e,t={}){var n;let o=Q(e),s=Object.assign(Object.assign({},this._requestOptions),t);return J(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(n=this.cachedContent)||void 0===n?void 0:n.name},o),s)}startChat(e){var t;return new en(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null===(t=this.cachedContent)||void 0===t?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){let n=function(e,t){var n;let o={model:null==t?void 0:t.model,generationConfig:null==t?void 0:t.generationConfig,safetySettings:null==t?void 0:t.safetySettings,tools:null==t?void 0:t.tools,toolConfig:null==t?void 0:t.toolConfig,systemInstruction:null==t?void 0:t.systemInstruction,cachedContent:null===(n=null==t?void 0:t.cachedContent)||void 0===n?void 0:n.name,contents:[]},s=null!=e.generateContentRequest;if(e.contents){if(s)throw new M("CountTokensRequest must have one of contents or generateContentRequest, not both.");o.contents=e.contents}else if(s)o=Object.assign(Object.assign({},o),e.generateContentRequest);else{let t=z(e);o.contents=[t]}return{generateContentRequest:o}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),o=Object.assign(Object.assign({},this._requestOptions),t);return eo(this.apiKey,this.model,n,o)}async embedContent(e,t={}){let n="string"==typeof e||Array.isArray(e)?{content:z(e)}:e,o=Object.assign(Object.assign({},this._requestOptions),t);return es(this.apiKey,this.model,n,o)}async batchEmbedContents(e,t={}){let n=Object.assign(Object.assign({},this._requestOptions),t);return ei(this.apiKey,this.model,e,n)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new N("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new er(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,n){if(!e.name)throw new M("Cached content must contain a `name` field.");if(!e.model)throw new M("Cached content must contain a `model` field.");for(let n of["model","systemInstruction"])if((null==t?void 0:t[n])&&e[n]&&(null==t?void 0:t[n])!==e[n]){if("model"===n&&(t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue;throw new M(`Different value for "${n}" specified in modelParams (${t[n]}) and cachedContent (${e[n]})`)}let o=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new er(this.apiKey,o,n)}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}]},["eqojD"],"eqojD","parcelRequire94c2");
//# sourceMappingURL=index.e0dc5474.js.map
